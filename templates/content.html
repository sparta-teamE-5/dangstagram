<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">

    <title>Title</title>
    <script>
        function add_comment_click(){
            let content_id = '627a7aa5d0ccb09c6db34b5a'
            let username ="이은지"
            let comment = $("#comment_data").val()
            if (comment == '') {
                    alert('내용을 입력하세요.')
               }else{
                   $.ajax({
                            type: "POST",
                            url: "/add_comment",
                            data: {
                             content_id: content_id,
                             username: username,comment:comment
                            },
                            cache: false,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                alert(response["msg"]);

                            }
                        });
                    }
               }
    </script>
    <style>
    .home-main {
    background-image: url(../static/background.png);
    background-repeat: no-repeat;
    background-size: cover;
    }
    .home-main-header {
    padding: 20px 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    }
    .home-main-header a {
        font-family: 'Roboto';
        font-style: normal;
        font-weight: bold;
        color: #FFFFFF;
    }
    .home-main-header-title > a {
    font-size: 40px;
    }
    .home-main-header-menu {
    display: flex;
    flex-wrap: nowrap;
    }
    .home-main-header-menu > a {
        flex-shrink: 0;
        font-size: 19px;
        margin: 0 15px;
    }
   .content_wrapper{
       background: #F1FDFF;
       padding: 100px;
       display: flex;
       flex-flow: row nowrap;
       justify-content: flex-start

       flex-grow: 1;

    }
    .card{
           margin: 10px;
           padding: 10px;
           flex-basis: 40%;
           display: flex;
           alig-content: flex-start;
           flex-wrap: wrap;
           flex-grow: 1;
           flex-shrink: 1;
    }
    .card-contents{
        display: flex;
        background: #ffffff;
        flex-flow: column nowrap;
        justify-content: center;
        flex-grow: 0;
    }

      .media_wrapper{
           margin: 10px;
           padding: 10px;
           flex-basis: 30%;
           display: flex;
           justify-content: center;
           flex-wrap: wrap;
           flex-grow: 1;
           flex-shrink: 1;
    }
    </style>
    <script>
        function delete_comment_click(comment_id){
         let boardID = "{{board._id }}";
         let commentID= comment_id;
          $.ajax({
                            type: "POST",
                            url: "/delete_comment",
                            data: {
                             boardID: boardID,commentID:commentID
                            },
                            cache: false,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                alert(response["msg"]);
                            }
                        });
        }

        function add_comment_click(){
            let boardID = "{{board._id}}"
            let userID  ="{{user}}"
            let comment = $("#comment_data").val()
            if (comment == '') {
                    alert('내용을 입력하세요.')
               }else{
                   $.ajax({
                            type: "POST",
                            url: "/add_comment",
                            data: {
                             content_id: content_id,
                             username: username,comment:comment
                            },
                            cache: false,
                            contentType: false,
                            processData: false,
                            success: function (response) {
                                window.location.reload();
                            }
                        });
                    }
               }

    </script>
</head>
<body>
<div class="home-wrapper">
    <div class="home-main">
        <div class="home-main-header">
            <div class="home-main-header-title">
                <a>Dogstagram</a>
            </div>
            <div class="home-main-header-menu">
                <a href="/addboard">자랑하기</a>
                <a>둘러보기</a>
                {% if isOn == 'on'%}
                <a onclick="logout()">로그아웃</a>
                {% else %}
                <a href="/login">로그인</a>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="content_wrapper">
        <div class="card">
            <div class="card-contents">
                <div class="card-image">
                    <img src="../static/small.png">
                </div>
                <header class="card-header">
                    <p class="card-header-title">{{post.title}}</p>
                </header>
                <div class="card-data">
                    <div class="content">
                        <p>
                            <strong>{{post.username}}</strong> <small>{{post.date}}</small>
                            <br>
                         {{post.contents}}
                       </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="comment-wrap media_wrapper">
            {% comments}
            <article class="media add-comment-article">
                <figure class="media-left">
                <p class="image is-64x64">
                  <img src="https://bulma.io/images/placeholders/128x128.png">
                </p>
              </figure>
                <div class="media-content">
            <div class="field">
              <p class="control">
                <textarea class="textarea" id="comment_data" placeholder="Add a comment..."></textarea>
              </p>
            </div>
            <nav class="level">
              <div class="level-left">
                <div class="level-item">
                  <a onclick="add_comment_click()" class="button is-info">Submit</a>
                </div>
              </div>
              <div class="level-right">
                <div class="level-item">
                  <label class="checkbox">
                    <input type="checkbox"> Press enter to submit
                  </label>
                </div>
              </div>
            </nav>
          </div>
            </article>
            {% else %}
            {% for comment in comments %}
            <article class="media comment-list-article">
                  <figure class="media-left">
                    <p class="image is-64x64">
                      <img src="https://bulma.io/images/placeholders/128x128.png">
                    </p>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <p>
                        <strong>{{comment.userID }}</strong>
                        <br>
                        {{comment.comment}}
                      </p>
                    </div>
                    <nav class="level is-mobile">
                      <div class="level-left">
                        <a class="level-item">
                          <span class="icon is-small"><i class="fas fa-reply"></i></span>
                        </a>
                        <a class="level-item">
                          <span class="icon is-small"><i class="fas fa-retweet"></i></span>
                        </a>
                        <a class="level-item">
                          <span class="icon is-small"><i class="fas fa-heart"></i></span>
                        </a>
                      </div>
                    </nav>
                  </div>
                  <div class="media-right">
                    <button onclick="delete_comment_click(comment._id)" class="delete"></button>
                  </div>
            </article>
            {% endfor %}
            {% endif %}
        </div>
    </div>
</div>

</body>
</html>